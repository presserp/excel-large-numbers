# excel-large-numbers
Calculation of large numbers in Excel in VBA

This repository contains a free add-in for calculating large numbers in Excel. Mourad Louha first developed this in 2010 with ideas from Heinz Schweigert from the German “Office-Lösung” Office forum for improving his original functions. Eric Presser started contributing to this in 2017. The Add-In currently implements functions for addition, subtraction, multiplication, exponentiation, quotient and mod of large numbers. The code in the Add-In is password protected; however you can unprotect the VBA project by using the password “excel-ticker” (without the quotes). The Add-In includes the functions which can be accessed, for example, through the category “User defined” of the select function box in Excel. Each function of the Add-In is available in English, German and French. The “Karatsuba algorithm” is used for addition, subtraction, multiplication and exponentiation. The true long school division algorithm is used for quotient and mod.

The next steps are to add decimal precision to the add-in. Once we have done this, the plan is to add square root (SQRT) and cube root (CUBERT.

Note that that there is a karatsuba method for calculating square root and also note that there was a paper written by S.A. Burr in April 1981 called COMPUTING CUBE ROOTS WHEN A FAST SQUARE ROOT IS AVAILABLE (https://ac.els-cdn.com/0898122182900414/1-s2.0-0898122182900414-main.pdf?_tid=2a01f98c-e85e-11e7-b7d2-00000aab0f6b&acdnat=1514087859_0a91fac316d40628ac6e5fd0e409ee02). Burr’s method converges faster than Newton’s method and will be used for calculating the cube root. Since Paul Zimmerman’s method (this is used in GMP, by the way, for square roots) will be used for the square root, this method will work quite well. The summary of Burr’s paper is that for the function, f(x) = x^^3 – a = 0, where a is the number we need to find the cube root, the following function, {X1} = (SQRT((4*a)/{X0}) + {X0})/3, will converge faster to the cube root than Newton’s method of {X1} = ((2*{X0})+[a/({X0}^^2)])/3, where {X0} is the initial guess. I have decided to use SQRT(SQRT(a)) as the initial guess as this will start of with the fourth root of a as a starting point and will converge faster than many other guesses. Since Karatsuba will be used internally to calculate SQRT it should work out nicely. The cube root will be made up up one sqrt, one multiplication and two divisions each iteration and it seems to converge about 6+ times faster for large numbers (in terms of iterations). Manually going through each iteration in excel (using the SQRT function and regular multiplication, addition and division), I tried finding the cube root of 10^^60 using both methods. Newton’s method (two multiplications and two divisions) took 58 iterations to produce the answer of 10^^20. Burr’s method took 9 iterations to produce the same answer. The difference between them is one sqrt using Burr’s method vs. one multiplication using Newton’s method. So hopefully using a fast sqrt of Karatsuba should make it faster with Burr’s method. I will have to do tests after I write the VBA code.
